---
title: "p8105_hw2_xs2330"
author: "Xiao Shi"
date: "September 26, 2018"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
```

## Problem 1
**Import, select, and tidy data**
```{r prob1 import data, message=FALSE}
NYC_Transit = 
  read_csv("./data_hw2/nyc_subway.csv") %>%
  janitor::clean_names() %>%
  select(line, station_name, station_latitude, station_longitude, route1, route2, route3, route4, route5, 
         route6, route7, route8, route9, route10, route11, entry, vending, entrance_type, ada)
NYC_Transit$entry = ifelse(NYC_Transit$entry == 'YES', TRUE,FALSE)
```

The `NYC_transit` dataset contains detailed information on station, routing, staffing, ada compliance, and vending. I used the janitor package to clean up the original data, and used the select function to choose the variables that will be focused on for this analysis. The dimension is `r nrow(NYC_Transit)` rows by `r ncol(NYC_Transit)` columns. However, the data is NOT tidy yet because the route number (variables route1 to route11) is spread across 11 columns.

**Distinct stations**
```{r}
distin_line = distinct(NYC_Transit[,c("line","station_name")])
```
The amount of distinct stations is `r nrow(distin_line)`

**Ada-compliant data**
```{r}
distin_ada_comp = select(NYC_Transit, line, station_name, ada) %>%
  distinct() %>%
  filter(ada == "TRUE")
```
There are `r nrow(distin_ada_comp)` stations that are ADA compliant

**Proportion of station exits without vending that allow entrance**
```{r}
distin_entry_novend = select(NYC_Transit, line, station_name, entry, vending) %>%
  distinct() %>%
  filter(vending == "NO")
prop_entry_novend = mean(distin_entry_novend$entry == "TRUE")
```
The proportion of station entrances / exits without vending allow entrance is `r prop_entry_novend`

**Reformat to tidy data**
```{r}
NYC_Transit = gather(NYC_Transit, key = "route_number", value = "route_name", route1:route11)
station_line_a = distinct(NYC_Transit[,c("line","station_name","route_name","ada")]) %>%
  filter(route_name == "A")
station_line_a_ada = filter(station_line_a, ada == TRUE)
```
There are `r nrow(station_line_a)` distinct stations that serves the A train  
There are `r nrow(station_line_a_ada)` distinct stations that serves the A train that are also ADA compliant

## Problem 2
**Read and clean Mr.Trash Wheel data**
```{r}
dumps = 
  read_excel("./data_hw2/HealthyHarborWaterWheelTotals2017-9-26.xlsx",sheet = 'Mr. Trash Wheel', range = cell_cols(1:14)) %>%
  janitor::clean_names() %>%
  na.omit(dumps)
dumps$sports_balls = as.integer(dumps$sports_balls)
```

**Read and clean Precip data for year 2016 and 2017**
```{r}
precip_2016 = read_excel("data_hw2/HealthyHarborWaterWheelTotals2017-9-26.xlsx",sheet = '2016 Precipitation',
                         range = "A2:B14") %>%
  na.omit(precip_2016)
colnames(precip_2016) = c("month", "total_precip_16")
precip_2016$year_16 = 2016

precip_2017 = read_excel("data_hw2/HealthyHarborWaterWheelTotals2017-9-26.xlsx",sheet = '2017 Precipitation',
                         range = "A2:B14") %>%
  na.omit(precip_2017)
colnames(precip_2017) = c("month", "total_precip_17")
precip_2017$year_17 = 2017
```
**Combine precip data for year 2016 and 2017**
```{r}
precip_1617 = left_join(precip_2016, precip_2017,by = "month")
precip_1617$month = month.name
```